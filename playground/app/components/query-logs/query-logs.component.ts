import { ChangeDetectionStrategy, Component } from '@angular/core';

import { of } from 'rxjs';


@Component({
  selector: 'query-logs',
  templateUrl: './query-logs.component.html',
  styleUrls: ['./query-logs.component.scss'],
  changeDetection: ChangeDetectionStrategy.OnPush,
})
export class QueryLogsComponent {

  public load = () => {
    return of({ paging:{ limit:10,offset:0,records:21 },data:[{ id:1227,query:'SELECT evaluations.enrollment_id AS enrollmentId,evaluations.evaluation_id AS evaluationId,evaluations.skill_group_id AS skillGroupId,evaluations.type,evaluations.notes,evaluations.event_id AS eventId,evaluation_scores.score,evaluation_scores.name AS scoreName,skills.name AS skillName,evaluation_skill_scores.skill_id AS skillId,evaluation_scores.color,COUNT(1) AS count,(SELECT MAX(score) FROM evaluation_scores evaluationScores WHERE ( `evaluationScores`.`type` = evaluations.type AND  `evaluationScores`.`environment_id` = skills.environment_id AND  `evaluationScores`.`state` = \'active\')) as maxScore FROM `evaluation_skill_scores` INNER JOIN `evaluations` ON  `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id LEFT JOIN `evaluation_scores` ON  `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id INNER JOIN `skills` ON  `evaluation_skill_scores`.`skill_id` = skills.skill_id WHERE  `evaluations`.`evaluation_id` IN (\'70660\',\'70675\',\'70306\',\'70472\',\'70633\',\'70634\',\'70636\',\'70637\',\'70324\',\'70407\',\'70408\',\'70639\',\'70640\',\'70337\',\'70401\',\'70402\',\'70642\',\'70643\',\'70107\',\'70108\',\'70665\',\'70666\',\'70667\',\'70673\',\'70674\',\'5577\',\'5495\',\'5496\',\'5499\')  GROUP BY evaluations.type,evaluations.skill_group_id,evaluations.enrollment_id,evaluation_skill_scores.score  ORDER BY `evaluation_scores`.`score` desc,`skills`.`order` ASC',duration:0.0024,explain:{ queryBlock:{ costInfo:{ queryCost:'91.80' },selectId:1,orderingOperation:{ usingFilesort:true,groupingOperation:{ nestedLoop:[{ table:{ key:'unique_evaluation_skill',costInfo:{ evalCost:'4.00',readCost:'21.26',prefixCost:'25.26',dataReadPerJoin:'157K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_skill_scores',accessType:'range',usedColumns:['evaluation_skill_score_id','evaluation_id','skill_id','evaluation_score_id','score'],possibleKeys:['unique_evaluation_skill','fk_evaluation_skill_scores_skill_id'],usedKeyParts:['evaluation_id'],indexCondition:'(`driver_training`.`evaluation_skill_scores`.`evaluation_id` in (70660,70675,70306,70472,70633,70634,70636,70637,70324,70407,70408,70639,70640,70337,70401,70402,70642,70643,70107,70108,70665,70666,70667,70673,70674,5577,5495,5496,5499))',rowsExaminedPerScan:40,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.skill_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'39.26',dataReadPerJoin:'482K' },filtered:'100.00',keyLength:'8',tableName:'skills',accessType:'eq_ref',usedColumns:['skill_id','environment_id','name','order'],possibleKeys:['PRIMARY'],usedKeyParts:['skill_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'53.26',dataReadPerJoin:'166K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'eq_ref',usedColumns:['evaluation_id','event_id','skill_group_id','enrollment_id','notes','type'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_score_id'],costInfo:{ evalCost:'4.00',readCost:'34.55',prefixCost:'91.81',dataReadPerJoin:'168K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_scores',accessType:'eq_ref',usedColumns:['evaluation_score_id','score','name','color'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_score_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } }],usingFilesort:false,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluation_scores_environment_id',ref:['func'],costInfo:{ evalCost:'0.01',readCost:'0.87',prefixCost:'0.97',dataReadPerJoin:'215' },filtered:'4.96',keyLength:'9',tableName:'evaluationScores',accessType:'ref',usedColumns:['environment_id','score','type','state'],possibleKeys:['fk_evaluation_scores_environment_id'],usedKeyParts:['environment_id'],attachedCondition:'((`driver_training`.`evaluationscores`.`state` = \'active\') and (`driver_training`.`evaluationscores`.`type` = `driver_training`.`evaluations`.`type`))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 },costInfo:{ queryCost:'0.97' },selectId:2 } }] } } } },optimized:false,createDate:'2024-01-16T18:47:43+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:91.8,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  evaluations.enrollment_id AS enrollmentId, \n  evaluations.evaluation_id AS evaluationId, \n  evaluations.skill_group_id AS skillGroupId, \n  evaluations.type, \n  evaluations.notes, \n  evaluations.event_id AS eventId, \n  evaluation_scores.score, \n  evaluation_scores.name AS scoreName, \n  skills.name AS skillName, \n  evaluation_skill_scores.skill_id AS skillId, \n  evaluation_scores.color, \n  COUNT(1) AS count, \n  (\n    SELECT \n      MAX(score) \n    FROM \n      evaluation_scores evaluationScores \n    WHERE \n      (\n        `evaluationScores`.`type` = evaluations.type \n        AND `evaluationScores`.`environment_id` = skills.environment_id \n        AND `evaluationScores`.`state` = \'active\'\n      )\n  ) as maxScore \nFROM \n  `evaluation_skill_scores` \n  INNER JOIN `evaluations` ON `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id \n  LEFT JOIN `evaluation_scores` ON `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id \n  INNER JOIN `skills` ON `evaluation_skill_scores`.`skill_id` = skills.skill_id \nWHERE \n  `evaluations`.`evaluation_id` IN (\n    \'70660\', \'70675\', \'70306\', \'70472\', \n    \'70633\', \'70634\', \'70636\', \'70637\', \n    \'70324\', \'70407\', \'70408\', \'70639\', \n    \'70640\', \'70337\', \'70401\', \'70402\', \n    \'70642\', \'70643\', \'70107\', \'70108\', \n    \'70665\', \'70666\', \'70667\', \'70673\', \n    \'70674\', \'5577\', \'5495\', \'5496\', \'5499\'\n  ) \nGROUP BY \n  evaluations.type, \n  evaluations.skill_group_id, \n  evaluations.enrollment_id, \n  evaluation_skill_scores.score \nORDER BY \n  `evaluation_scores`.`score` desc, \n  `skills`.`order` ASC;' },{ id:1219,query:'SELECT enrollments.*,(students.first_name) AS `studentName`,(SELECT IFNULL(SUM(event_activities.duration),0) \/ 60 FROM `events` INNER JOIN `event_objects` ON  `events`.`event_id` = event_objects.event_id INNER JOIN `event_activities` ON  `events`.`event_id` = event_activities.event_id LEFT JOIN `object_modules` ON ( `events`.`module_id` = object_modules.module_id AND  `object_modules`.`object_id` = enrollments.enrollment_id) WHERE ( `events`.`state` = \'active\' AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id AND  `object_modules`.`module_id` IS null)) AS `notEnrollmentModuleHours`,(SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  `payments`.`state` = \'active\')) AS `paymentTotal`,(SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\'))) AS `invoiceTotal`,(ABS((SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW())) - (SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW() AND  `payments`.`state` = \'active\')))) AS `invoiceOverdueTotal`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  IFNULL(students.email, \'\') <> \'\' AND  ( `events`.`end` < DATE_ADD(offices.student_publish_date, INTERVAL 1 DAY) AND  ( `events`.`start` > NOW() AND  `event_objects`.`notify_date` IS null)) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `unsentChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `event_objects`.`change_type` IS NOT null AND  IFNULL(students.email, \'\') = \'\' AND  `events`.`start` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `manualChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  ( `events`.`start` > NOW() AND  `details`.`confirmation_state` = \'not_going\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `notGoingCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  `signoffs`.`state` IN (\'disagree\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `disagreeCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `details`.`confirmation_state` IS null AND  `event_objects`.`change_type` IS null AND  `events`.`end` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingResponseCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  (`signoffs`.`state` IN (null) OR signoffs.state IS null) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingSignoffCount`,(SELECT GROUP_CONCAT(evaluation_id) FROM `evaluations` WHERE (   evaluations.evaluation_id IN (SELECT MAX(latestEvaluations.evaluation_id) FROM evaluations latestEvaluations WHERE ( `latestEvaluations`.`state` = \'active\' AND  `evaluations`.`state` = \'active\' AND  `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id)  GROUP BY latestEvaluations.type,latestEvaluations.skill_group_id) AND  `evaluations`.`enrollment_id` = enrollments.enrollment_id)) AS `evaluationIds` FROM `enrollments` INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id INNER JOIN `offices` ON  `enrollments`.`office_id` = offices.office_id WHERE ( `students`.`state` = \'active\' AND  `offices`.`environment_id` = \'6\' AND  `enrollments`.`office_id` IN (\'7\') AND  `enrollments`.`status_id` IN (\'6314\') AND  `enrollments`.`state` = \'active\')  ORDER BY `studentName` ASC LIMIT 25',duration:0.0505,explain:{ queryBlock:{ costInfo:{ queryCost:'13.90' },selectId:1,orderingOperation:{ costInfo:{ sortCost:'0.63' },nestedLoop:[{ table:{ key:'PRIMARY',ref:['const'],costInfo:{ evalCost:'0.10',readCost:'0.00',prefixCost:'0.00',dataReadPerJoin:'496' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'const',usedColumns:['office_id','environment_id'],possibleKeys:['PRIMARY','fk_offices_environment_id'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:1 } },{ table:{ key:'fk_enrollments_office_id',ref:['const'],costInfo:{ evalCost:'0.63',readCost:'0.75',prefixCost:'11.05',dataReadPerJoin:'860' },filtered:'6.14',keyLength:'8',tableName:'enrollments',accessType:'ref',usedColumns:['enrollment_id','student_id','office_id','create_date','start_date','complete_date','state','contract_id','status_id','object_version_id','package_id','course_id'],possibleKeys:['fk_enrollments_student_id','fk_enrollments_office_id','fk_enrollments_status_id'],usedKeyParts:['office_id'],indexCondition:'(`driver_training`.`enrollments`.`office_id` = 7)',attachedCondition:'(((`driver_training`.`enrollments`.`state` = \'active\') and (`driver_training`.`enrollments`.`status_id` = 6314)) and (`driver_training`.`enrollments`.`student_id` is not null))',rowsExaminedPerScan:103,rowsProducedPerJoin:6 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.06',readCost:'1.58',prefixCost:'13.26',dataReadPerJoin:'693' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','first_name','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }],usingFilesort:true,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'1.14',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'47K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'ref',usedColumns:['evaluation_id','enrollment_id','state'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'<in_optimizer>(`driver_training`.`evaluations`.`evaluation_id`,<exists>(\/* select#14 *\/ select max(`driver_training`.`latestevaluations`.`evaluation_id`) from `driver_training`.`evaluations` `latestevaluations` where ((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\') and (`driver_training`.`latestevaluations`.`enrollment_id` = `driver_training`.`evaluations`.`enrollment_id`)) group by `driver_training`.`latestevaluations`.`type`,`driver_training`.`latestevaluations`.`skill_group_id` having (<cache>(`driver_training`.`evaluations`.`evaluation_id`) = <ref_null_helper>(max(`driver_training`.`latestevaluations`.`evaluation_id`)))))',attachedSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.39' },selectId:14,groupingOperation:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.evaluations.enrollment_id'],costInfo:{ evalCost:'0.11',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'latestEvaluations',accessType:'ref',usedColumns:['evaluation_id','skill_group_id','enrollment_id','state','type'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\'))',rowsExaminedPerScan:11,rowsProducedPerJoin:1 },usingFilesort:false,usingTemporaryTable:true } } }],rowsExaminedPerScan:11,rowsProducedPerJoin:11 },costInfo:{ queryCost:'3.39' },selectId:13 } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:12,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'19.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'<if>(found_match(signoffs), ((`driver_training`.`signoffs`.`state` = NULL) or (`driver_training`.`signoffs`.`state` is null)), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:11,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`end` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'<if>(found_match(details), (`driver_training`.`details`.`confirmation_state` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:10,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id','fk_details_signoff_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'(`driver_training`.`signoffs`.`state` = \'disagree\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:9,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'3' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`confirmation_state` = \'not_going\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:8,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') = \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'9.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is not null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:7,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') <> \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','notify_date'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`notify_date` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usedColumns:['office_id','student_publish_date'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],attachedCondition:'(`driver_training`.`events`.`end` < (`driver_training`.`offices`.`student_publish_date` + interval 1 day))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:6,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:5,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:4,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:3,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.29' },selectId:2,nestedLoop:[{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.58',readCost:'0.26',prefixCost:'0.84',dataReadPerJoin:'1K' },filtered:'100.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usingIndex:true,usedColumns:['object_id','event_id','state'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.06',readCost:'1.44',prefixCost:'2.85',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','module_id'],possibleKeys:['PRIMARY'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_object_module',ref:['driver_training.enrollments.enrollment_id','driver_training.events.module_id'],costInfo:{ evalCost:'0.06',readCost:'0.14',prefixCost:'3.05',dataReadPerJoin:'13' },filtered:'100.00',keyLength:'16',notExists:true,tableName:'object_modules',accessType:'eq_ref',usingIndex:true,usedColumns:['module_id','object_id'],possibleKeys:['unique_object_module','fk_object_modules_module_id'],usedKeyParts:['object_id','module_id'],attachedCondition:'<if>(found_match(object_modules), (`driver_training`.`object_modules`.`module_id` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_event_id_activity_id',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.07',readCost:'0.17',prefixCost:'3.29',dataReadPerJoin:'22' },filtered:'100.00',keyLength:'8',tableName:'event_activities',accessType:'ref',usedColumns:['event_id','duration'],possibleKeys:['unique_event_id_activity_id'],usedKeyParts:['event_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } }] } } },optimized:false,createDate:'2024-01-16T18:47:43+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:13.9,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  enrollments.*, \n  (students.first_name) AS `studentName`, \n  (\n    SELECT \n      IFNULL(\n        SUM(event_activities.duration), \n        0\n      ) \/ 60 \n    FROM \n      `events` \n      INNER JOIN `event_objects` ON `events`.`event_id` = event_objects.event_id \n      INNER JOIN `event_activities` ON `events`.`event_id` = event_activities.event_id \n      LEFT JOIN `object_modules` ON (\n        `events`.`module_id` = object_modules.module_id \n        AND `object_modules`.`object_id` = enrollments.enrollment_id\n      ) \n    WHERE \n      (\n        `events`.`state` = \'active\' \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id \n        AND `object_modules`.`module_id` IS null\n      )\n  ) AS `notEnrollmentModuleHours`, \n  (\n    SELECT \n      IFNULL(\n        SUM(payments.amount), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n      INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\') \n        AND `payments`.`state` = \'active\'\n      )\n  ) AS `paymentTotal`, \n  (\n    SELECT \n      IFNULL(\n        SUM(invoice_abstracts.total), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\')\n      )\n  ) AS `invoiceTotal`, \n  (\n    ABS(\n      (\n        SELECT \n          IFNULL(\n            SUM(invoice_abstracts.total), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW()\n          )\n      ) - (\n        SELECT \n          IFNULL(\n            SUM(payments.amount), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n          INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW() \n            AND `payments`.`state` = \'active\'\n          )\n      )\n    )\n  ) AS `invoiceOverdueTotal`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND IFNULL(students.email, \'\') <> \'\' \n        AND (\n          `events`.`end` < DATE_ADD(\n            offices.student_publish_date, INTERVAL 1 DAY\n          ) \n          AND (\n            `events`.`start` > NOW() \n            AND `event_objects`.`notify_date` IS null\n          )\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `unsentChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `event_objects`.`change_type` IS NOT null \n          AND IFNULL(students.email, \'\') = \'\' \n          AND `events`.`start` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `manualChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `events`.`start` > NOW() \n          AND `details`.`confirmation_state` = \'not_going\'\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `notGoingCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND `signoffs`.`state` IN (\'disagree\') \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `disagreeCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `details`.`confirmation_state` IS null \n          AND `event_objects`.`change_type` IS null \n          AND `events`.`end` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingResponseCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND (\n          `signoffs`.`state` IN (null) \n          OR signoffs.state IS null\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingSignoffCount`, \n  (\n    SELECT \n      GROUP_CONCAT(evaluation_id) \n    FROM \n      `evaluations` \n    WHERE \n      (\n        evaluations.evaluation_id IN (\n          SELECT \n            MAX(\n              latestEvaluations.evaluation_id\n            ) \n          FROM \n            evaluations latestEvaluations \n          WHERE \n            (\n              `latestEvaluations`.`state` = \'active\' \n              AND `evaluations`.`state` = \'active\' \n              AND `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id\n            ) \n          GROUP BY \n            latestEvaluations.type, \n            latestEvaluations.skill_group_id\n        ) \n        AND `evaluations`.`enrollment_id` = enrollments.enrollment_id\n      )\n  ) AS `evaluationIds` \nFROM \n  `enrollments` \n  INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n  INNER JOIN `offices` ON `enrollments`.`office_id` = offices.office_id \nWHERE \n  (\n    `students`.`state` = \'active\' \n    AND `offices`.`environment_id` = \'6\' \n    AND `enrollments`.`office_id` IN (\'7\') \n    AND `enrollments`.`status_id` IN (\'6314\') \n    AND `enrollments`.`state` = \'active\'\n  ) \nORDER BY \n  `studentName` ASC \nLIMIT \n  25;' },{ id:1068,query:'SELECT evaluations.enrollment_id AS enrollmentId,evaluations.evaluation_id AS evaluationId,evaluations.skill_group_id AS skillGroupId,evaluations.type,evaluations.notes,evaluations.event_id AS eventId,evaluation_scores.score,evaluation_scores.name AS scoreName,skills.name AS skillName,evaluation_skill_scores.skill_id AS skillId,evaluation_scores.color,COUNT(1) AS count,(SELECT MAX(score) FROM evaluation_scores evaluationScores WHERE ( `evaluationScores`.`type` = evaluations.type AND  `evaluationScores`.`environment_id` = skills.environment_id AND  `evaluationScores`.`state` = \'active\')) as maxScore FROM `evaluation_skill_scores` INNER JOIN `evaluations` ON  `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id LEFT JOIN `evaluation_scores` ON  `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id INNER JOIN `skills` ON  `evaluation_skill_scores`.`skill_id` = skills.skill_id WHERE  `evaluations`.`evaluation_id` IN (\'70660\',\'70675\',\'70306\',\'70472\',\'70633\',\'70634\',\'70636\',\'70637\',\'70324\',\'70407\',\'70408\',\'70639\',\'70640\',\'70337\',\'70401\',\'70402\',\'70642\',\'70643\',\'70107\',\'70108\',\'70665\',\'70666\',\'70667\',\'70673\',\'70674\',\'5577\',\'5495\',\'5496\',\'5499\')  GROUP BY evaluations.type,evaluations.skill_group_id,evaluations.enrollment_id,evaluation_skill_scores.score  ORDER BY `evaluation_scores`.`score` desc,`skills`.`order` ASC',duration:0.0133,explain:{ queryBlock:{ costInfo:{ queryCost:'91.80' },selectId:1,orderingOperation:{ usingFilesort:true,groupingOperation:{ nestedLoop:[{ table:{ key:'unique_evaluation_skill',costInfo:{ evalCost:'4.00',readCost:'21.26',prefixCost:'25.26',dataReadPerJoin:'157K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_skill_scores',accessType:'range',usedColumns:['evaluation_skill_score_id','evaluation_id','skill_id','evaluation_score_id','score'],possibleKeys:['unique_evaluation_skill','fk_evaluation_skill_scores_skill_id'],usedKeyParts:['evaluation_id'],indexCondition:'(`driver_training`.`evaluation_skill_scores`.`evaluation_id` in (70660,70675,70306,70472,70633,70634,70636,70637,70324,70407,70408,70639,70640,70337,70401,70402,70642,70643,70107,70108,70665,70666,70667,70673,70674,5577,5495,5496,5499))',rowsExaminedPerScan:40,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.skill_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'39.26',dataReadPerJoin:'482K' },filtered:'100.00',keyLength:'8',tableName:'skills',accessType:'eq_ref',usedColumns:['skill_id','environment_id','name','order'],possibleKeys:['PRIMARY'],usedKeyParts:['skill_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'53.26',dataReadPerJoin:'166K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'eq_ref',usedColumns:['evaluation_id','event_id','skill_group_id','enrollment_id','notes','type'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_score_id'],costInfo:{ evalCost:'4.00',readCost:'34.55',prefixCost:'91.81',dataReadPerJoin:'168K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_scores',accessType:'eq_ref',usedColumns:['evaluation_score_id','score','name','color'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_score_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } }],usingFilesort:false,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluation_scores_environment_id',ref:['func'],costInfo:{ evalCost:'0.01',readCost:'0.87',prefixCost:'0.97',dataReadPerJoin:'215' },filtered:'4.96',keyLength:'9',tableName:'evaluationScores',accessType:'ref',usedColumns:['environment_id','score','type','state'],possibleKeys:['fk_evaluation_scores_environment_id'],usedKeyParts:['environment_id'],attachedCondition:'((`driver_training`.`evaluationscores`.`state` = \'active\') and (`driver_training`.`evaluationscores`.`type` = `driver_training`.`evaluations`.`type`))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 },costInfo:{ queryCost:'0.97' },selectId:2 } }] } } } },optimized:false,createDate:'2024-01-16T18:41:42+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:91.8,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  evaluations.enrollment_id AS enrollmentId, \n  evaluations.evaluation_id AS evaluationId, \n  evaluations.skill_group_id AS skillGroupId, \n  evaluations.type, \n  evaluations.notes, \n  evaluations.event_id AS eventId, \n  evaluation_scores.score, \n  evaluation_scores.name AS scoreName, \n  skills.name AS skillName, \n  evaluation_skill_scores.skill_id AS skillId, \n  evaluation_scores.color, \n  COUNT(1) AS count, \n  (\n    SELECT \n      MAX(score) \n    FROM \n      evaluation_scores evaluationScores \n    WHERE \n      (\n        `evaluationScores`.`type` = evaluations.type \n        AND `evaluationScores`.`environment_id` = skills.environment_id \n        AND `evaluationScores`.`state` = \'active\'\n      )\n  ) as maxScore \nFROM \n  `evaluation_skill_scores` \n  INNER JOIN `evaluations` ON `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id \n  LEFT JOIN `evaluation_scores` ON `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id \n  INNER JOIN `skills` ON `evaluation_skill_scores`.`skill_id` = skills.skill_id \nWHERE \n  `evaluations`.`evaluation_id` IN (\n    \'70660\', \'70675\', \'70306\', \'70472\', \n    \'70633\', \'70634\', \'70636\', \'70637\', \n    \'70324\', \'70407\', \'70408\', \'70639\', \n    \'70640\', \'70337\', \'70401\', \'70402\', \n    \'70642\', \'70643\', \'70107\', \'70108\', \n    \'70665\', \'70666\', \'70667\', \'70673\', \n    \'70674\', \'5577\', \'5495\', \'5496\', \'5499\'\n  ) \nGROUP BY \n  evaluations.type, \n  evaluations.skill_group_id, \n  evaluations.enrollment_id, \n  evaluation_skill_scores.score \nORDER BY \n  `evaluation_scores`.`score` desc, \n  `skills`.`order` ASC;' },{ id:1060,query:'SELECT enrollments.*,(students.first_name) AS `studentName`,(SELECT IFNULL(SUM(event_activities.duration),0) \/ 60 FROM `events` INNER JOIN `event_objects` ON  `events`.`event_id` = event_objects.event_id INNER JOIN `event_activities` ON  `events`.`event_id` = event_activities.event_id LEFT JOIN `object_modules` ON ( `events`.`module_id` = object_modules.module_id AND  `object_modules`.`object_id` = enrollments.enrollment_id) WHERE ( `events`.`state` = \'active\' AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id AND  `object_modules`.`module_id` IS null)) AS `notEnrollmentModuleHours`,(SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  `payments`.`state` = \'active\')) AS `paymentTotal`,(SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\'))) AS `invoiceTotal`,(ABS((SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW())) - (SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW() AND  `payments`.`state` = \'active\')))) AS `invoiceOverdueTotal`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  IFNULL(students.email, \'\') <> \'\' AND  ( `events`.`end` < DATE_ADD(offices.student_publish_date, INTERVAL 1 DAY) AND  ( `events`.`start` > NOW() AND  `event_objects`.`notify_date` IS null)) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `unsentChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `event_objects`.`change_type` IS NOT null AND  IFNULL(students.email, \'\') = \'\' AND  `events`.`start` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `manualChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  ( `events`.`start` > NOW() AND  `details`.`confirmation_state` = \'not_going\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `notGoingCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  `signoffs`.`state` IN (\'disagree\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `disagreeCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `details`.`confirmation_state` IS null AND  `event_objects`.`change_type` IS null AND  `events`.`end` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingResponseCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  (`signoffs`.`state` IN (null) OR signoffs.state IS null) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingSignoffCount`,(SELECT GROUP_CONCAT(evaluation_id) FROM `evaluations` WHERE (   evaluations.evaluation_id IN (SELECT MAX(latestEvaluations.evaluation_id) FROM evaluations latestEvaluations WHERE ( `latestEvaluations`.`state` = \'active\' AND  `evaluations`.`state` = \'active\' AND  `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id)  GROUP BY latestEvaluations.type,latestEvaluations.skill_group_id) AND  `evaluations`.`enrollment_id` = enrollments.enrollment_id)) AS `evaluationIds` FROM `enrollments` INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id INNER JOIN `offices` ON  `enrollments`.`office_id` = offices.office_id WHERE ( `students`.`state` = \'active\' AND  `offices`.`environment_id` = \'6\' AND  `enrollments`.`office_id` IN (\'7\') AND  `enrollments`.`status_id` IN (\'6314\') AND  `enrollments`.`state` = \'active\')  ORDER BY `studentName` ASC LIMIT 25',duration:0.0646,explain:{ queryBlock:{ costInfo:{ queryCost:'13.90' },selectId:1,orderingOperation:{ costInfo:{ sortCost:'0.63' },nestedLoop:[{ table:{ key:'PRIMARY',ref:['const'],costInfo:{ evalCost:'0.10',readCost:'0.00',prefixCost:'0.00',dataReadPerJoin:'496' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'const',usedColumns:['office_id','environment_id'],possibleKeys:['PRIMARY','fk_offices_environment_id'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:1 } },{ table:{ key:'fk_enrollments_office_id',ref:['const'],costInfo:{ evalCost:'0.63',readCost:'0.75',prefixCost:'11.05',dataReadPerJoin:'860' },filtered:'6.14',keyLength:'8',tableName:'enrollments',accessType:'ref',usedColumns:['enrollment_id','student_id','office_id','create_date','start_date','complete_date','state','contract_id','status_id','object_version_id','package_id','course_id'],possibleKeys:['fk_enrollments_student_id','fk_enrollments_office_id','fk_enrollments_status_id'],usedKeyParts:['office_id'],indexCondition:'(`driver_training`.`enrollments`.`office_id` = 7)',attachedCondition:'(((`driver_training`.`enrollments`.`state` = \'active\') and (`driver_training`.`enrollments`.`status_id` = 6314)) and (`driver_training`.`enrollments`.`student_id` is not null))',rowsExaminedPerScan:103,rowsProducedPerJoin:6 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.06',readCost:'1.58',prefixCost:'13.26',dataReadPerJoin:'693' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','first_name','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }],usingFilesort:true,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'1.14',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'47K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'ref',usedColumns:['evaluation_id','enrollment_id','state'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'<in_optimizer>(`driver_training`.`evaluations`.`evaluation_id`,<exists>(\/* select#14 *\/ select max(`driver_training`.`latestevaluations`.`evaluation_id`) from `driver_training`.`evaluations` `latestevaluations` where ((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\') and (`driver_training`.`latestevaluations`.`enrollment_id` = `driver_training`.`evaluations`.`enrollment_id`)) group by `driver_training`.`latestevaluations`.`type`,`driver_training`.`latestevaluations`.`skill_group_id` having (<cache>(`driver_training`.`evaluations`.`evaluation_id`) = <ref_null_helper>(max(`driver_training`.`latestevaluations`.`evaluation_id`)))))',attachedSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.39' },selectId:14,groupingOperation:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.evaluations.enrollment_id'],costInfo:{ evalCost:'0.11',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'latestEvaluations',accessType:'ref',usedColumns:['evaluation_id','skill_group_id','enrollment_id','state','type'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\'))',rowsExaminedPerScan:11,rowsProducedPerJoin:1 },usingFilesort:false,usingTemporaryTable:true } } }],rowsExaminedPerScan:11,rowsProducedPerJoin:11 },costInfo:{ queryCost:'3.39' },selectId:13 } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:12,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'19.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'<if>(found_match(signoffs), ((`driver_training`.`signoffs`.`state` = NULL) or (`driver_training`.`signoffs`.`state` is null)), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:11,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`end` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'<if>(found_match(details), (`driver_training`.`details`.`confirmation_state` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:10,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id','fk_details_signoff_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'(`driver_training`.`signoffs`.`state` = \'disagree\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:9,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'3' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`confirmation_state` = \'not_going\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:8,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') = \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'9.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is not null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:7,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') <> \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','notify_date'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`notify_date` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usedColumns:['office_id','student_publish_date'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],attachedCondition:'(`driver_training`.`events`.`end` < (`driver_training`.`offices`.`student_publish_date` + interval 1 day))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:6,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:5,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:4,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:3,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.29' },selectId:2,nestedLoop:[{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.58',readCost:'0.26',prefixCost:'0.84',dataReadPerJoin:'1K' },filtered:'100.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usingIndex:true,usedColumns:['object_id','event_id','state'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.06',readCost:'1.44',prefixCost:'2.85',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','module_id'],possibleKeys:['PRIMARY'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_object_module',ref:['driver_training.enrollments.enrollment_id','driver_training.events.module_id'],costInfo:{ evalCost:'0.06',readCost:'0.14',prefixCost:'3.05',dataReadPerJoin:'13' },filtered:'100.00',keyLength:'16',notExists:true,tableName:'object_modules',accessType:'eq_ref',usingIndex:true,usedColumns:['module_id','object_id'],possibleKeys:['unique_object_module','fk_object_modules_module_id'],usedKeyParts:['object_id','module_id'],attachedCondition:'<if>(found_match(object_modules), (`driver_training`.`object_modules`.`module_id` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_event_id_activity_id',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.07',readCost:'0.17',prefixCost:'3.29',dataReadPerJoin:'22' },filtered:'100.00',keyLength:'8',tableName:'event_activities',accessType:'ref',usedColumns:['event_id','duration'],possibleKeys:['unique_event_id_activity_id'],usedKeyParts:['event_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } }] } } },optimized:false,createDate:'2024-01-16T18:41:41+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:13.9,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  enrollments.*, \n  (students.first_name) AS `studentName`, \n  (\n    SELECT \n      IFNULL(\n        SUM(event_activities.duration), \n        0\n      ) \/ 60 \n    FROM \n      `events` \n      INNER JOIN `event_objects` ON `events`.`event_id` = event_objects.event_id \n      INNER JOIN `event_activities` ON `events`.`event_id` = event_activities.event_id \n      LEFT JOIN `object_modules` ON (\n        `events`.`module_id` = object_modules.module_id \n        AND `object_modules`.`object_id` = enrollments.enrollment_id\n      ) \n    WHERE \n      (\n        `events`.`state` = \'active\' \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id \n        AND `object_modules`.`module_id` IS null\n      )\n  ) AS `notEnrollmentModuleHours`, \n  (\n    SELECT \n      IFNULL(\n        SUM(payments.amount), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n      INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\') \n        AND `payments`.`state` = \'active\'\n      )\n  ) AS `paymentTotal`, \n  (\n    SELECT \n      IFNULL(\n        SUM(invoice_abstracts.total), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\')\n      )\n  ) AS `invoiceTotal`, \n  (\n    ABS(\n      (\n        SELECT \n          IFNULL(\n            SUM(invoice_abstracts.total), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW()\n          )\n      ) - (\n        SELECT \n          IFNULL(\n            SUM(payments.amount), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n          INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW() \n            AND `payments`.`state` = \'active\'\n          )\n      )\n    )\n  ) AS `invoiceOverdueTotal`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND IFNULL(students.email, \'\') <> \'\' \n        AND (\n          `events`.`end` < DATE_ADD(\n            offices.student_publish_date, INTERVAL 1 DAY\n          ) \n          AND (\n            `events`.`start` > NOW() \n            AND `event_objects`.`notify_date` IS null\n          )\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `unsentChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `event_objects`.`change_type` IS NOT null \n          AND IFNULL(students.email, \'\') = \'\' \n          AND `events`.`start` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `manualChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `events`.`start` > NOW() \n          AND `details`.`confirmation_state` = \'not_going\'\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `notGoingCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND `signoffs`.`state` IN (\'disagree\') \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `disagreeCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `details`.`confirmation_state` IS null \n          AND `event_objects`.`change_type` IS null \n          AND `events`.`end` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingResponseCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND (\n          `signoffs`.`state` IN (null) \n          OR signoffs.state IS null\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingSignoffCount`, \n  (\n    SELECT \n      GROUP_CONCAT(evaluation_id) \n    FROM \n      `evaluations` \n    WHERE \n      (\n        evaluations.evaluation_id IN (\n          SELECT \n            MAX(\n              latestEvaluations.evaluation_id\n            ) \n          FROM \n            evaluations latestEvaluations \n          WHERE \n            (\n              `latestEvaluations`.`state` = \'active\' \n              AND `evaluations`.`state` = \'active\' \n              AND `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id\n            ) \n          GROUP BY \n            latestEvaluations.type, \n            latestEvaluations.skill_group_id\n        ) \n        AND `evaluations`.`enrollment_id` = enrollments.enrollment_id\n      )\n  ) AS `evaluationIds` \nFROM \n  `enrollments` \n  INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n  INNER JOIN `offices` ON `enrollments`.`office_id` = offices.office_id \nWHERE \n  (\n    `students`.`state` = \'active\' \n    AND `offices`.`environment_id` = \'6\' \n    AND `enrollments`.`office_id` IN (\'7\') \n    AND `enrollments`.`status_id` IN (\'6314\') \n    AND `enrollments`.`state` = \'active\'\n  ) \nORDER BY \n  `studentName` ASC \nLIMIT \n  25;' },{ id:1012,query:'SELECT evaluations.enrollment_id AS enrollmentId,evaluations.evaluation_id AS evaluationId,evaluations.skill_group_id AS skillGroupId,evaluations.type,evaluations.notes,evaluations.event_id AS eventId,evaluation_scores.score,evaluation_scores.name AS scoreName,skills.name AS skillName,evaluation_skill_scores.skill_id AS skillId,evaluation_scores.color,COUNT(1) AS count,(SELECT MAX(score) FROM evaluation_scores evaluationScores WHERE ( `evaluationScores`.`type` = evaluations.type AND  `evaluationScores`.`environment_id` = skills.environment_id AND  `evaluationScores`.`state` = \'active\')) as maxScore FROM `evaluation_skill_scores` INNER JOIN `evaluations` ON  `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id LEFT JOIN `evaluation_scores` ON  `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id INNER JOIN `skills` ON  `evaluation_skill_scores`.`skill_id` = skills.skill_id WHERE  `evaluations`.`evaluation_id` IN (\'70660\',\'70675\',\'70306\',\'70472\',\'70633\',\'70634\',\'70636\',\'70637\',\'70324\',\'70407\',\'70408\',\'70639\',\'70640\',\'70337\',\'70401\',\'70402\',\'70642\',\'70643\',\'70107\',\'70108\',\'70665\',\'70666\',\'70667\',\'70673\',\'70674\',\'5577\',\'5495\',\'5496\',\'5499\')  GROUP BY evaluations.type,evaluations.skill_group_id,evaluations.enrollment_id,evaluation_skill_scores.score  ORDER BY `evaluation_scores`.`score` desc,`skills`.`order` ASC',duration:0.0011,explain:{ queryBlock:{ costInfo:{ queryCost:'91.80' },selectId:1,orderingOperation:{ usingFilesort:true,groupingOperation:{ nestedLoop:[{ table:{ key:'unique_evaluation_skill',costInfo:{ evalCost:'4.00',readCost:'21.26',prefixCost:'25.26',dataReadPerJoin:'157K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_skill_scores',accessType:'range',usedColumns:['evaluation_skill_score_id','evaluation_id','skill_id','evaluation_score_id','score'],possibleKeys:['unique_evaluation_skill','fk_evaluation_skill_scores_skill_id'],usedKeyParts:['evaluation_id'],indexCondition:'(`driver_training`.`evaluation_skill_scores`.`evaluation_id` in (70660,70675,70306,70472,70633,70634,70636,70637,70324,70407,70408,70639,70640,70337,70401,70402,70642,70643,70107,70108,70665,70666,70667,70673,70674,5577,5495,5496,5499))',rowsExaminedPerScan:40,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.skill_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'39.26',dataReadPerJoin:'482K' },filtered:'100.00',keyLength:'8',tableName:'skills',accessType:'eq_ref',usedColumns:['skill_id','environment_id','name','order'],possibleKeys:['PRIMARY'],usedKeyParts:['skill_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'53.26',dataReadPerJoin:'166K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'eq_ref',usedColumns:['evaluation_id','event_id','skill_group_id','enrollment_id','notes','type'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_score_id'],costInfo:{ evalCost:'4.00',readCost:'34.55',prefixCost:'91.81',dataReadPerJoin:'168K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_scores',accessType:'eq_ref',usedColumns:['evaluation_score_id','score','name','color'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_score_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } }],usingFilesort:false,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluation_scores_environment_id',ref:['func'],costInfo:{ evalCost:'0.01',readCost:'0.87',prefixCost:'0.97',dataReadPerJoin:'215' },filtered:'4.96',keyLength:'9',tableName:'evaluationScores',accessType:'ref',usedColumns:['environment_id','score','type','state'],possibleKeys:['fk_evaluation_scores_environment_id'],usedKeyParts:['environment_id'],attachedCondition:'((`driver_training`.`evaluationscores`.`state` = \'active\') and (`driver_training`.`evaluationscores`.`type` = `driver_training`.`evaluations`.`type`))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 },costInfo:{ queryCost:'0.97' },selectId:2 } }] } } } },optimized:false,createDate:'2024-01-16T18:40:17+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:91.8,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  evaluations.enrollment_id AS enrollmentId, \n  evaluations.evaluation_id AS evaluationId, \n  evaluations.skill_group_id AS skillGroupId, \n  evaluations.type, \n  evaluations.notes, \n  evaluations.event_id AS eventId, \n  evaluation_scores.score, \n  evaluation_scores.name AS scoreName, \n  skills.name AS skillName, \n  evaluation_skill_scores.skill_id AS skillId, \n  evaluation_scores.color, \n  COUNT(1) AS count, \n  (\n    SELECT \n      MAX(score) \n    FROM \n      evaluation_scores evaluationScores \n    WHERE \n      (\n        `evaluationScores`.`type` = evaluations.type \n        AND `evaluationScores`.`environment_id` = skills.environment_id \n        AND `evaluationScores`.`state` = \'active\'\n      )\n  ) as maxScore \nFROM \n  `evaluation_skill_scores` \n  INNER JOIN `evaluations` ON `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id \n  LEFT JOIN `evaluation_scores` ON `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id \n  INNER JOIN `skills` ON `evaluation_skill_scores`.`skill_id` = skills.skill_id \nWHERE \n  `evaluations`.`evaluation_id` IN (\n    \'70660\', \'70675\', \'70306\', \'70472\', \n    \'70633\', \'70634\', \'70636\', \'70637\', \n    \'70324\', \'70407\', \'70408\', \'70639\', \n    \'70640\', \'70337\', \'70401\', \'70402\', \n    \'70642\', \'70643\', \'70107\', \'70108\', \n    \'70665\', \'70666\', \'70667\', \'70673\', \n    \'70674\', \'5577\', \'5495\', \'5496\', \'5499\'\n  ) \nGROUP BY \n  evaluations.type, \n  evaluations.skill_group_id, \n  evaluations.enrollment_id, \n  evaluation_skill_scores.score \nORDER BY \n  `evaluation_scores`.`score` desc, \n  `skills`.`order` ASC;' },{ id:1004,query:'SELECT enrollments.*,(students.first_name) AS `studentName`,(SELECT IFNULL(SUM(event_activities.duration),0) \/ 60 FROM `events` INNER JOIN `event_objects` ON  `events`.`event_id` = event_objects.event_id INNER JOIN `event_activities` ON  `events`.`event_id` = event_activities.event_id LEFT JOIN `object_modules` ON ( `events`.`module_id` = object_modules.module_id AND  `object_modules`.`object_id` = enrollments.enrollment_id) WHERE ( `events`.`state` = \'active\' AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id AND  `object_modules`.`module_id` IS null)) AS `notEnrollmentModuleHours`,(SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  `payments`.`state` = \'active\')) AS `paymentTotal`,(SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\'))) AS `invoiceTotal`,(ABS((SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW())) - (SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW() AND  `payments`.`state` = \'active\')))) AS `invoiceOverdueTotal`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  IFNULL(students.email, \'\') <> \'\' AND  ( `events`.`end` < DATE_ADD(offices.student_publish_date, INTERVAL 1 DAY) AND  ( `events`.`start` > NOW() AND  `event_objects`.`notify_date` IS null)) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `unsentChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `event_objects`.`change_type` IS NOT null AND  IFNULL(students.email, \'\') = \'\' AND  `events`.`start` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `manualChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  ( `events`.`start` > NOW() AND  `details`.`confirmation_state` = \'not_going\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `notGoingCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  `signoffs`.`state` IN (\'disagree\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `disagreeCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `details`.`confirmation_state` IS null AND  `event_objects`.`change_type` IS null AND  `events`.`end` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingResponseCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  (`signoffs`.`state` IN (null) OR signoffs.state IS null) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingSignoffCount`,(SELECT GROUP_CONCAT(evaluation_id) FROM `evaluations` WHERE (   evaluations.evaluation_id IN (SELECT MAX(latestEvaluations.evaluation_id) FROM evaluations latestEvaluations WHERE ( `latestEvaluations`.`state` = \'active\' AND  `evaluations`.`state` = \'active\' AND  `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id)  GROUP BY latestEvaluations.type,latestEvaluations.skill_group_id) AND  `evaluations`.`enrollment_id` = enrollments.enrollment_id)) AS `evaluationIds` FROM `enrollments` INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id INNER JOIN `offices` ON  `enrollments`.`office_id` = offices.office_id WHERE ( `students`.`state` = \'active\' AND  `offices`.`environment_id` = \'6\' AND  `enrollments`.`office_id` IN (\'7\') AND  `enrollments`.`status_id` IN (\'6314\') AND  `enrollments`.`state` = \'active\')  ORDER BY `studentName` ASC LIMIT 25',duration:0.0293,explain:{ queryBlock:{ costInfo:{ queryCost:'13.90' },selectId:1,orderingOperation:{ costInfo:{ sortCost:'0.63' },nestedLoop:[{ table:{ key:'PRIMARY',ref:['const'],costInfo:{ evalCost:'0.10',readCost:'0.00',prefixCost:'0.00',dataReadPerJoin:'496' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'const',usedColumns:['office_id','environment_id'],possibleKeys:['PRIMARY','fk_offices_environment_id'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:1 } },{ table:{ key:'fk_enrollments_office_id',ref:['const'],costInfo:{ evalCost:'0.63',readCost:'0.75',prefixCost:'11.05',dataReadPerJoin:'860' },filtered:'6.14',keyLength:'8',tableName:'enrollments',accessType:'ref',usedColumns:['enrollment_id','student_id','office_id','create_date','start_date','complete_date','state','contract_id','status_id','object_version_id','package_id','course_id'],possibleKeys:['fk_enrollments_student_id','fk_enrollments_office_id','fk_enrollments_status_id'],usedKeyParts:['office_id'],indexCondition:'(`driver_training`.`enrollments`.`office_id` = 7)',attachedCondition:'(((`driver_training`.`enrollments`.`state` = \'active\') and (`driver_training`.`enrollments`.`status_id` = 6314)) and (`driver_training`.`enrollments`.`student_id` is not null))',rowsExaminedPerScan:103,rowsProducedPerJoin:6 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.06',readCost:'1.58',prefixCost:'13.26',dataReadPerJoin:'693' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','first_name','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }],usingFilesort:true,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'1.14',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'47K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'ref',usedColumns:['evaluation_id','enrollment_id','state'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'<in_optimizer>(`driver_training`.`evaluations`.`evaluation_id`,<exists>(\/* select#14 *\/ select max(`driver_training`.`latestevaluations`.`evaluation_id`) from `driver_training`.`evaluations` `latestevaluations` where ((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\') and (`driver_training`.`latestevaluations`.`enrollment_id` = `driver_training`.`evaluations`.`enrollment_id`)) group by `driver_training`.`latestevaluations`.`type`,`driver_training`.`latestevaluations`.`skill_group_id` having (<cache>(`driver_training`.`evaluations`.`evaluation_id`) = <ref_null_helper>(max(`driver_training`.`latestevaluations`.`evaluation_id`)))))',attachedSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.39' },selectId:14,groupingOperation:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.evaluations.enrollment_id'],costInfo:{ evalCost:'0.11',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'latestEvaluations',accessType:'ref',usedColumns:['evaluation_id','skill_group_id','enrollment_id','state','type'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\'))',rowsExaminedPerScan:11,rowsProducedPerJoin:1 },usingFilesort:false,usingTemporaryTable:true } } }],rowsExaminedPerScan:11,rowsProducedPerJoin:11 },costInfo:{ queryCost:'3.39' },selectId:13 } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:12,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'19.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'<if>(found_match(signoffs), ((`driver_training`.`signoffs`.`state` = NULL) or (`driver_training`.`signoffs`.`state` is null)), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:11,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`end` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'<if>(found_match(details), (`driver_training`.`details`.`confirmation_state` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:10,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id','fk_details_signoff_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'(`driver_training`.`signoffs`.`state` = \'disagree\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:9,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'3' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`confirmation_state` = \'not_going\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:8,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') = \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'9.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is not null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:7,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') <> \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','notify_date'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`notify_date` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usedColumns:['office_id','student_publish_date'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],attachedCondition:'(`driver_training`.`events`.`end` < (`driver_training`.`offices`.`student_publish_date` + interval 1 day))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:6,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:5,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:4,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:3,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.29' },selectId:2,nestedLoop:[{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.58',readCost:'0.26',prefixCost:'0.84',dataReadPerJoin:'1K' },filtered:'100.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usingIndex:true,usedColumns:['object_id','event_id','state'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.06',readCost:'1.44',prefixCost:'2.85',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','module_id'],possibleKeys:['PRIMARY'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_object_module',ref:['driver_training.enrollments.enrollment_id','driver_training.events.module_id'],costInfo:{ evalCost:'0.06',readCost:'0.14',prefixCost:'3.05',dataReadPerJoin:'13' },filtered:'100.00',keyLength:'16',notExists:true,tableName:'object_modules',accessType:'eq_ref',usingIndex:true,usedColumns:['module_id','object_id'],possibleKeys:['unique_object_module','fk_object_modules_module_id'],usedKeyParts:['object_id','module_id'],attachedCondition:'<if>(found_match(object_modules), (`driver_training`.`object_modules`.`module_id` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_event_id_activity_id',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.07',readCost:'0.17',prefixCost:'3.29',dataReadPerJoin:'22' },filtered:'100.00',keyLength:'8',tableName:'event_activities',accessType:'ref',usedColumns:['event_id','duration'],possibleKeys:['unique_event_id_activity_id'],usedKeyParts:['event_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } }] } } },optimized:false,createDate:'2024-01-16T18:40:16+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:13.9,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  enrollments.*, \n  (students.first_name) AS `studentName`, \n  (\n    SELECT \n      IFNULL(\n        SUM(event_activities.duration), \n        0\n      ) \/ 60 \n    FROM \n      `events` \n      INNER JOIN `event_objects` ON `events`.`event_id` = event_objects.event_id \n      INNER JOIN `event_activities` ON `events`.`event_id` = event_activities.event_id \n      LEFT JOIN `object_modules` ON (\n        `events`.`module_id` = object_modules.module_id \n        AND `object_modules`.`object_id` = enrollments.enrollment_id\n      ) \n    WHERE \n      (\n        `events`.`state` = \'active\' \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id \n        AND `object_modules`.`module_id` IS null\n      )\n  ) AS `notEnrollmentModuleHours`, \n  (\n    SELECT \n      IFNULL(\n        SUM(payments.amount), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n      INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\') \n        AND `payments`.`state` = \'active\'\n      )\n  ) AS `paymentTotal`, \n  (\n    SELECT \n      IFNULL(\n        SUM(invoice_abstracts.total), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\')\n      )\n  ) AS `invoiceTotal`, \n  (\n    ABS(\n      (\n        SELECT \n          IFNULL(\n            SUM(invoice_abstracts.total), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW()\n          )\n      ) - (\n        SELECT \n          IFNULL(\n            SUM(payments.amount), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n          INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW() \n            AND `payments`.`state` = \'active\'\n          )\n      )\n    )\n  ) AS `invoiceOverdueTotal`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND IFNULL(students.email, \'\') <> \'\' \n        AND (\n          `events`.`end` < DATE_ADD(\n            offices.student_publish_date, INTERVAL 1 DAY\n          ) \n          AND (\n            `events`.`start` > NOW() \n            AND `event_objects`.`notify_date` IS null\n          )\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `unsentChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `event_objects`.`change_type` IS NOT null \n          AND IFNULL(students.email, \'\') = \'\' \n          AND `events`.`start` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `manualChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `events`.`start` > NOW() \n          AND `details`.`confirmation_state` = \'not_going\'\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `notGoingCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND `signoffs`.`state` IN (\'disagree\') \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `disagreeCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `details`.`confirmation_state` IS null \n          AND `event_objects`.`change_type` IS null \n          AND `events`.`end` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingResponseCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND (\n          `signoffs`.`state` IN (null) \n          OR signoffs.state IS null\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingSignoffCount`, \n  (\n    SELECT \n      GROUP_CONCAT(evaluation_id) \n    FROM \n      `evaluations` \n    WHERE \n      (\n        evaluations.evaluation_id IN (\n          SELECT \n            MAX(\n              latestEvaluations.evaluation_id\n            ) \n          FROM \n            evaluations latestEvaluations \n          WHERE \n            (\n              `latestEvaluations`.`state` = \'active\' \n              AND `evaluations`.`state` = \'active\' \n              AND `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id\n            ) \n          GROUP BY \n            latestEvaluations.type, \n            latestEvaluations.skill_group_id\n        ) \n        AND `evaluations`.`enrollment_id` = enrollments.enrollment_id\n      )\n  ) AS `evaluationIds` \nFROM \n  `enrollments` \n  INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n  INNER JOIN `offices` ON `enrollments`.`office_id` = offices.office_id \nWHERE \n  (\n    `students`.`state` = \'active\' \n    AND `offices`.`environment_id` = \'6\' \n    AND `enrollments`.`office_id` IN (\'7\') \n    AND `enrollments`.`status_id` IN (\'6314\') \n    AND `enrollments`.`state` = \'active\'\n  ) \nORDER BY \n  `studentName` ASC \nLIMIT \n  25;' },{ id:615,query:'SELECT evaluations.enrollment_id AS enrollmentId,evaluations.evaluation_id AS evaluationId,evaluations.skill_group_id AS skillGroupId,evaluations.type,evaluations.notes,evaluations.event_id AS eventId,evaluation_scores.score,evaluation_scores.name AS scoreName,skills.name AS skillName,evaluation_skill_scores.skill_id AS skillId,evaluation_scores.color,COUNT(1) AS count,(SELECT MAX(score) FROM evaluation_scores evaluationScores WHERE ( `evaluationScores`.`type` = evaluations.type AND  `evaluationScores`.`environment_id` = skills.environment_id AND  `evaluationScores`.`state` = \'active\')) as maxScore FROM `evaluation_skill_scores` INNER JOIN `evaluations` ON  `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id LEFT JOIN `evaluation_scores` ON  `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id INNER JOIN `skills` ON  `evaluation_skill_scores`.`skill_id` = skills.skill_id WHERE  `evaluations`.`evaluation_id` IN (\'70660\',\'70675\',\'70306\',\'70472\',\'70633\',\'70634\',\'70636\',\'70637\',\'70324\',\'70407\',\'70408\',\'70639\',\'70640\',\'70337\',\'70401\',\'70402\',\'70642\',\'70643\',\'70107\',\'70108\',\'70665\',\'70666\',\'70667\',\'70673\',\'70674\',\'5577\',\'5495\',\'5496\',\'5499\')  GROUP BY evaluations.type,evaluations.skill_group_id,evaluations.enrollment_id,evaluation_skill_scores.score  ORDER BY `evaluation_scores`.`score` desc,`skills`.`order` ASC',duration:0.0021,explain:{ queryBlock:{ costInfo:{ queryCost:'91.80' },selectId:1,orderingOperation:{ usingFilesort:true,groupingOperation:{ nestedLoop:[{ table:{ key:'unique_evaluation_skill',costInfo:{ evalCost:'4.00',readCost:'21.26',prefixCost:'25.26',dataReadPerJoin:'157K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_skill_scores',accessType:'range',usedColumns:['evaluation_skill_score_id','evaluation_id','skill_id','evaluation_score_id','score'],possibleKeys:['unique_evaluation_skill','fk_evaluation_skill_scores_skill_id'],usedKeyParts:['evaluation_id'],indexCondition:'(`driver_training`.`evaluation_skill_scores`.`evaluation_id` in (70660,70675,70306,70472,70633,70634,70636,70637,70324,70407,70408,70639,70640,70337,70401,70402,70642,70643,70107,70108,70665,70666,70667,70673,70674,5577,5495,5496,5499))',rowsExaminedPerScan:40,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.skill_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'39.26',dataReadPerJoin:'482K' },filtered:'100.00',keyLength:'8',tableName:'skills',accessType:'eq_ref',usedColumns:['skill_id','environment_id','name','order'],possibleKeys:['PRIMARY'],usedKeyParts:['skill_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'53.26',dataReadPerJoin:'166K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'eq_ref',usedColumns:['evaluation_id','event_id','skill_group_id','enrollment_id','notes','type'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_score_id'],costInfo:{ evalCost:'4.00',readCost:'34.55',prefixCost:'91.81',dataReadPerJoin:'168K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_scores',accessType:'eq_ref',usedColumns:['evaluation_score_id','score','name','color'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_score_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } }],usingFilesort:false,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluation_scores_environment_id',ref:['func'],costInfo:{ evalCost:'0.01',readCost:'0.87',prefixCost:'0.97',dataReadPerJoin:'215' },filtered:'4.96',keyLength:'9',tableName:'evaluationScores',accessType:'ref',usedColumns:['environment_id','score','type','state'],possibleKeys:['fk_evaluation_scores_environment_id'],usedKeyParts:['environment_id'],attachedCondition:'((`driver_training`.`evaluationscores`.`state` = \'active\') and (`driver_training`.`evaluationscores`.`type` = `driver_training`.`evaluations`.`type`))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 },costInfo:{ queryCost:'0.97' },selectId:2 } }] } } } },optimized:false,createDate:'2024-01-16T18:09:56+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:91.8,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  evaluations.enrollment_id AS enrollmentId, \n  evaluations.evaluation_id AS evaluationId, \n  evaluations.skill_group_id AS skillGroupId, \n  evaluations.type, \n  evaluations.notes, \n  evaluations.event_id AS eventId, \n  evaluation_scores.score, \n  evaluation_scores.name AS scoreName, \n  skills.name AS skillName, \n  evaluation_skill_scores.skill_id AS skillId, \n  evaluation_scores.color, \n  COUNT(1) AS count, \n  (\n    SELECT \n      MAX(score) \n    FROM \n      evaluation_scores evaluationScores \n    WHERE \n      (\n        `evaluationScores`.`type` = evaluations.type \n        AND `evaluationScores`.`environment_id` = skills.environment_id \n        AND `evaluationScores`.`state` = \'active\'\n      )\n  ) as maxScore \nFROM \n  `evaluation_skill_scores` \n  INNER JOIN `evaluations` ON `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id \n  LEFT JOIN `evaluation_scores` ON `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id \n  INNER JOIN `skills` ON `evaluation_skill_scores`.`skill_id` = skills.skill_id \nWHERE \n  `evaluations`.`evaluation_id` IN (\n    \'70660\', \'70675\', \'70306\', \'70472\', \n    \'70633\', \'70634\', \'70636\', \'70637\', \n    \'70324\', \'70407\', \'70408\', \'70639\', \n    \'70640\', \'70337\', \'70401\', \'70402\', \n    \'70642\', \'70643\', \'70107\', \'70108\', \n    \'70665\', \'70666\', \'70667\', \'70673\', \n    \'70674\', \'5577\', \'5495\', \'5496\', \'5499\'\n  ) \nGROUP BY \n  evaluations.type, \n  evaluations.skill_group_id, \n  evaluations.enrollment_id, \n  evaluation_skill_scores.score \nORDER BY \n  `evaluation_scores`.`score` desc, \n  `skills`.`order` ASC;' },{ id:607,query:'SELECT enrollments.*,(students.first_name) AS `studentName`,(SELECT IFNULL(SUM(event_activities.duration),0) \/ 60 FROM `events` INNER JOIN `event_objects` ON  `events`.`event_id` = event_objects.event_id INNER JOIN `event_activities` ON  `events`.`event_id` = event_activities.event_id LEFT JOIN `object_modules` ON ( `events`.`module_id` = object_modules.module_id AND  `object_modules`.`object_id` = enrollments.enrollment_id) WHERE ( `events`.`state` = \'active\' AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id AND  `object_modules`.`module_id` IS null)) AS `notEnrollmentModuleHours`,(SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  `payments`.`state` = \'active\')) AS `paymentTotal`,(SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\'))) AS `invoiceTotal`,(ABS((SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW())) - (SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW() AND  `payments`.`state` = \'active\')))) AS `invoiceOverdueTotal`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  IFNULL(students.email, \'\') <> \'\' AND  ( `events`.`end` < DATE_ADD(offices.student_publish_date, INTERVAL 1 DAY) AND  ( `events`.`start` > NOW() AND  `event_objects`.`notify_date` IS null)) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `unsentChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `event_objects`.`change_type` IS NOT null AND  IFNULL(students.email, \'\') = \'\' AND  `events`.`start` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `manualChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  ( `events`.`start` > NOW() AND  `details`.`confirmation_state` = \'not_going\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `notGoingCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  `signoffs`.`state` IN (\'disagree\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `disagreeCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `details`.`confirmation_state` IS null AND  `event_objects`.`change_type` IS null AND  `events`.`end` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingResponseCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  (`signoffs`.`state` IN (null) OR signoffs.state IS null) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingSignoffCount`,(SELECT GROUP_CONCAT(evaluation_id) FROM `evaluations` WHERE (   evaluations.evaluation_id IN (SELECT MAX(latestEvaluations.evaluation_id) FROM evaluations latestEvaluations WHERE ( `latestEvaluations`.`state` = \'active\' AND  `evaluations`.`state` = \'active\' AND  `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id)  GROUP BY latestEvaluations.type,latestEvaluations.skill_group_id) AND  `evaluations`.`enrollment_id` = enrollments.enrollment_id)) AS `evaluationIds` FROM `enrollments` INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id INNER JOIN `offices` ON  `enrollments`.`office_id` = offices.office_id WHERE ( `students`.`state` = \'active\' AND  `offices`.`environment_id` = \'6\' AND  `enrollments`.`office_id` IN (\'7\') AND  `enrollments`.`status_id` IN (\'6314\') AND  `enrollments`.`state` = \'active\')  ORDER BY `studentName` ASC LIMIT 25',duration:0.05,explain:{ queryBlock:{ costInfo:{ queryCost:'13.90' },selectId:1,orderingOperation:{ costInfo:{ sortCost:'0.63' },nestedLoop:[{ table:{ key:'PRIMARY',ref:['const'],costInfo:{ evalCost:'0.10',readCost:'0.00',prefixCost:'0.00',dataReadPerJoin:'496' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'const',usedColumns:['office_id','environment_id'],possibleKeys:['PRIMARY','fk_offices_environment_id'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:1 } },{ table:{ key:'fk_enrollments_office_id',ref:['const'],costInfo:{ evalCost:'0.63',readCost:'0.75',prefixCost:'11.05',dataReadPerJoin:'860' },filtered:'6.14',keyLength:'8',tableName:'enrollments',accessType:'ref',usedColumns:['enrollment_id','student_id','office_id','create_date','start_date','complete_date','state','contract_id','status_id','object_version_id','package_id','course_id'],possibleKeys:['fk_enrollments_student_id','fk_enrollments_office_id','fk_enrollments_status_id'],usedKeyParts:['office_id'],indexCondition:'(`driver_training`.`enrollments`.`office_id` = 7)',attachedCondition:'(((`driver_training`.`enrollments`.`state` = \'active\') and (`driver_training`.`enrollments`.`status_id` = 6314)) and (`driver_training`.`enrollments`.`student_id` is not null))',rowsExaminedPerScan:103,rowsProducedPerJoin:6 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.06',readCost:'1.58',prefixCost:'13.26',dataReadPerJoin:'693' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','first_name','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }],usingFilesort:true,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'1.14',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'47K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'ref',usedColumns:['evaluation_id','enrollment_id','state'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'<in_optimizer>(`driver_training`.`evaluations`.`evaluation_id`,<exists>(\/* select#14 *\/ select max(`driver_training`.`latestevaluations`.`evaluation_id`) from `driver_training`.`evaluations` `latestevaluations` where ((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\') and (`driver_training`.`latestevaluations`.`enrollment_id` = `driver_training`.`evaluations`.`enrollment_id`)) group by `driver_training`.`latestevaluations`.`type`,`driver_training`.`latestevaluations`.`skill_group_id` having (<cache>(`driver_training`.`evaluations`.`evaluation_id`) = <ref_null_helper>(max(`driver_training`.`latestevaluations`.`evaluation_id`)))))',attachedSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.39' },selectId:14,groupingOperation:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.evaluations.enrollment_id'],costInfo:{ evalCost:'0.11',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'latestEvaluations',accessType:'ref',usedColumns:['evaluation_id','skill_group_id','enrollment_id','state','type'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\'))',rowsExaminedPerScan:11,rowsProducedPerJoin:1 },usingFilesort:false,usingTemporaryTable:true } } }],rowsExaminedPerScan:11,rowsProducedPerJoin:11 },costInfo:{ queryCost:'3.39' },selectId:13 } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:12,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'19.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'<if>(found_match(signoffs), ((`driver_training`.`signoffs`.`state` = NULL) or (`driver_training`.`signoffs`.`state` is null)), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:11,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`end` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'<if>(found_match(details), (`driver_training`.`details`.`confirmation_state` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:10,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id','fk_details_signoff_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'(`driver_training`.`signoffs`.`state` = \'disagree\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:9,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'3' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`confirmation_state` = \'not_going\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:8,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') = \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'9.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is not null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:7,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') <> \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','notify_date'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`notify_date` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usedColumns:['office_id','student_publish_date'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],attachedCondition:'(`driver_training`.`events`.`end` < (`driver_training`.`offices`.`student_publish_date` + interval 1 day))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:6,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:5,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:4,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:3,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.29' },selectId:2,nestedLoop:[{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.58',readCost:'0.26',prefixCost:'0.84',dataReadPerJoin:'1K' },filtered:'100.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usingIndex:true,usedColumns:['object_id','event_id','state'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.06',readCost:'1.44',prefixCost:'2.85',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','module_id'],possibleKeys:['PRIMARY'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_object_module',ref:['driver_training.enrollments.enrollment_id','driver_training.events.module_id'],costInfo:{ evalCost:'0.06',readCost:'0.14',prefixCost:'3.05',dataReadPerJoin:'13' },filtered:'100.00',keyLength:'16',notExists:true,tableName:'object_modules',accessType:'eq_ref',usingIndex:true,usedColumns:['module_id','object_id'],possibleKeys:['unique_object_module','fk_object_modules_module_id'],usedKeyParts:['object_id','module_id'],attachedCondition:'<if>(found_match(object_modules), (`driver_training`.`object_modules`.`module_id` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_event_id_activity_id',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.07',readCost:'0.17',prefixCost:'3.29',dataReadPerJoin:'22' },filtered:'100.00',keyLength:'8',tableName:'event_activities',accessType:'ref',usedColumns:['event_id','duration'],possibleKeys:['unique_event_id_activity_id'],usedKeyParts:['event_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } }] } } },optimized:false,createDate:'2024-01-16T18:09:56+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:13.9,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  enrollments.*, \n  (students.first_name) AS `studentName`, \n  (\n    SELECT \n      IFNULL(\n        SUM(event_activities.duration), \n        0\n      ) \/ 60 \n    FROM \n      `events` \n      INNER JOIN `event_objects` ON `events`.`event_id` = event_objects.event_id \n      INNER JOIN `event_activities` ON `events`.`event_id` = event_activities.event_id \n      LEFT JOIN `object_modules` ON (\n        `events`.`module_id` = object_modules.module_id \n        AND `object_modules`.`object_id` = enrollments.enrollment_id\n      ) \n    WHERE \n      (\n        `events`.`state` = \'active\' \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id \n        AND `object_modules`.`module_id` IS null\n      )\n  ) AS `notEnrollmentModuleHours`, \n  (\n    SELECT \n      IFNULL(\n        SUM(payments.amount), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n      INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\') \n        AND `payments`.`state` = \'active\'\n      )\n  ) AS `paymentTotal`, \n  (\n    SELECT \n      IFNULL(\n        SUM(invoice_abstracts.total), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\')\n      )\n  ) AS `invoiceTotal`, \n  (\n    ABS(\n      (\n        SELECT \n          IFNULL(\n            SUM(invoice_abstracts.total), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW()\n          )\n      ) - (\n        SELECT \n          IFNULL(\n            SUM(payments.amount), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n          INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW() \n            AND `payments`.`state` = \'active\'\n          )\n      )\n    )\n  ) AS `invoiceOverdueTotal`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND IFNULL(students.email, \'\') <> \'\' \n        AND (\n          `events`.`end` < DATE_ADD(\n            offices.student_publish_date, INTERVAL 1 DAY\n          ) \n          AND (\n            `events`.`start` > NOW() \n            AND `event_objects`.`notify_date` IS null\n          )\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `unsentChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `event_objects`.`change_type` IS NOT null \n          AND IFNULL(students.email, \'\') = \'\' \n          AND `events`.`start` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `manualChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `events`.`start` > NOW() \n          AND `details`.`confirmation_state` = \'not_going\'\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `notGoingCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND `signoffs`.`state` IN (\'disagree\') \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `disagreeCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `details`.`confirmation_state` IS null \n          AND `event_objects`.`change_type` IS null \n          AND `events`.`end` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingResponseCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND (\n          `signoffs`.`state` IN (null) \n          OR signoffs.state IS null\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingSignoffCount`, \n  (\n    SELECT \n      GROUP_CONCAT(evaluation_id) \n    FROM \n      `evaluations` \n    WHERE \n      (\n        evaluations.evaluation_id IN (\n          SELECT \n            MAX(\n              latestEvaluations.evaluation_id\n            ) \n          FROM \n            evaluations latestEvaluations \n          WHERE \n            (\n              `latestEvaluations`.`state` = \'active\' \n              AND `evaluations`.`state` = \'active\' \n              AND `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id\n            ) \n          GROUP BY \n            latestEvaluations.type, \n            latestEvaluations.skill_group_id\n        ) \n        AND `evaluations`.`enrollment_id` = enrollments.enrollment_id\n      )\n  ) AS `evaluationIds` \nFROM \n  `enrollments` \n  INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n  INNER JOIN `offices` ON `enrollments`.`office_id` = offices.office_id \nWHERE \n  (\n    `students`.`state` = \'active\' \n    AND `offices`.`environment_id` = \'6\' \n    AND `enrollments`.`office_id` IN (\'7\') \n    AND `enrollments`.`status_id` IN (\'6314\') \n    AND `enrollments`.`state` = \'active\'\n  ) \nORDER BY \n  `studentName` ASC \nLIMIT \n  25;' },{ id:200,query:'SELECT evaluations.enrollment_id AS enrollmentId,evaluations.evaluation_id AS evaluationId,evaluations.skill_group_id AS skillGroupId,evaluations.type,evaluations.notes,evaluations.event_id AS eventId,evaluation_scores.score,evaluation_scores.name AS scoreName,skills.name AS skillName,evaluation_skill_scores.skill_id AS skillId,evaluation_scores.color,COUNT(1) AS count,(SELECT MAX(score) FROM evaluation_scores evaluationScores WHERE ( `evaluationScores`.`type` = evaluations.type AND  `evaluationScores`.`environment_id` = skills.environment_id AND  `evaluationScores`.`state` = \'active\')) as maxScore FROM `evaluation_skill_scores` INNER JOIN `evaluations` ON  `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id LEFT JOIN `evaluation_scores` ON  `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id INNER JOIN `skills` ON  `evaluation_skill_scores`.`skill_id` = skills.skill_id WHERE  `evaluations`.`evaluation_id` IN (\'70660\',\'70675\',\'70306\',\'70472\',\'70633\',\'70634\',\'70636\',\'70637\',\'70324\',\'70407\',\'70408\',\'70639\',\'70640\',\'70337\',\'70401\',\'70402\',\'70642\',\'70643\',\'70107\',\'70108\',\'70665\',\'70666\',\'70667\',\'70673\',\'70674\',\'5577\',\'5495\',\'5496\',\'5499\')  GROUP BY evaluations.type,evaluations.skill_group_id,evaluations.enrollment_id,evaluation_skill_scores.score  ORDER BY `evaluation_scores`.`score` desc,`skills`.`order` ASC',duration:0.0021,explain:{ queryBlock:{ costInfo:{ queryCost:'91.80' },selectId:1,orderingOperation:{ usingFilesort:true,groupingOperation:{ nestedLoop:[{ table:{ key:'unique_evaluation_skill',costInfo:{ evalCost:'4.00',readCost:'21.26',prefixCost:'25.26',dataReadPerJoin:'157K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_skill_scores',accessType:'range',usedColumns:['evaluation_skill_score_id','evaluation_id','skill_id','evaluation_score_id','score'],possibleKeys:['unique_evaluation_skill','fk_evaluation_skill_scores_skill_id'],usedKeyParts:['evaluation_id'],indexCondition:'(`driver_training`.`evaluation_skill_scores`.`evaluation_id` in (70660,70675,70306,70472,70633,70634,70636,70637,70324,70407,70408,70639,70640,70337,70401,70402,70642,70643,70107,70108,70665,70666,70667,70673,70674,5577,5495,5496,5499))',rowsExaminedPerScan:40,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.skill_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'39.26',dataReadPerJoin:'482K' },filtered:'100.00',keyLength:'8',tableName:'skills',accessType:'eq_ref',usedColumns:['skill_id','environment_id','name','order'],possibleKeys:['PRIMARY'],usedKeyParts:['skill_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_id'],costInfo:{ evalCost:'4.00',readCost:'10.00',prefixCost:'53.26',dataReadPerJoin:'166K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'eq_ref',usedColumns:['evaluation_id','event_id','skill_group_id','enrollment_id','notes','type'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } },{ table:{ key:'PRIMARY',ref:['driver_training.evaluation_skill_scores.evaluation_score_id'],costInfo:{ evalCost:'4.00',readCost:'34.55',prefixCost:'91.81',dataReadPerJoin:'168K' },filtered:'100.00',keyLength:'8',tableName:'evaluation_scores',accessType:'eq_ref',usedColumns:['evaluation_score_id','score','name','color'],possibleKeys:['PRIMARY'],usedKeyParts:['evaluation_score_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:40 } }],usingFilesort:false,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluation_scores_environment_id',ref:['func'],costInfo:{ evalCost:'0.01',readCost:'0.87',prefixCost:'0.97',dataReadPerJoin:'215' },filtered:'4.96',keyLength:'9',tableName:'evaluationScores',accessType:'ref',usedColumns:['environment_id','score','type','state'],possibleKeys:['fk_evaluation_scores_environment_id'],usedKeyParts:['environment_id'],attachedCondition:'((`driver_training`.`evaluationscores`.`state` = \'active\') and (`driver_training`.`evaluationscores`.`type` = `driver_training`.`evaluations`.`type`))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 },costInfo:{ queryCost:'0.97' },selectId:2 } }] } } } },optimized:false,createDate:'2024-01-16T17:45:52+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:91.8,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  evaluations.enrollment_id AS enrollmentId, \n  evaluations.evaluation_id AS evaluationId, \n  evaluations.skill_group_id AS skillGroupId, \n  evaluations.type, \n  evaluations.notes, \n  evaluations.event_id AS eventId, \n  evaluation_scores.score, \n  evaluation_scores.name AS scoreName, \n  skills.name AS skillName, \n  evaluation_skill_scores.skill_id AS skillId, \n  evaluation_scores.color, \n  COUNT(1) AS count, \n  (\n    SELECT \n      MAX(score) \n    FROM \n      evaluation_scores evaluationScores \n    WHERE \n      (\n        `evaluationScores`.`type` = evaluations.type \n        AND `evaluationScores`.`environment_id` = skills.environment_id \n        AND `evaluationScores`.`state` = \'active\'\n      )\n  ) as maxScore \nFROM \n  `evaluation_skill_scores` \n  INNER JOIN `evaluations` ON `evaluation_skill_scores`.`evaluation_id` = evaluations.evaluation_id \n  LEFT JOIN `evaluation_scores` ON `evaluation_skill_scores`.`evaluation_score_id` = evaluation_scores.evaluation_score_id \n  INNER JOIN `skills` ON `evaluation_skill_scores`.`skill_id` = skills.skill_id \nWHERE \n  `evaluations`.`evaluation_id` IN (\n    \'70660\', \'70675\', \'70306\', \'70472\', \n    \'70633\', \'70634\', \'70636\', \'70637\', \n    \'70324\', \'70407\', \'70408\', \'70639\', \n    \'70640\', \'70337\', \'70401\', \'70402\', \n    \'70642\', \'70643\', \'70107\', \'70108\', \n    \'70665\', \'70666\', \'70667\', \'70673\', \n    \'70674\', \'5577\', \'5495\', \'5496\', \'5499\'\n  ) \nGROUP BY \n  evaluations.type, \n  evaluations.skill_group_id, \n  evaluations.enrollment_id, \n  evaluation_skill_scores.score \nORDER BY \n  `evaluation_scores`.`score` desc, \n  `skills`.`order` ASC;' },{ id:192,query:'SELECT enrollments.*,(students.first_name) AS `studentName`,(SELECT IFNULL(SUM(event_activities.duration),0) \/ 60 FROM `events` INNER JOIN `event_objects` ON  `events`.`event_id` = event_objects.event_id INNER JOIN `event_activities` ON  `events`.`event_id` = event_activities.event_id LEFT JOIN `object_modules` ON ( `events`.`module_id` = object_modules.module_id AND  `object_modules`.`object_id` = enrollments.enrollment_id) WHERE ( `events`.`state` = \'active\' AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id AND  `object_modules`.`module_id` IS null)) AS `notEnrollmentModuleHours`,(SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  `payments`.`state` = \'active\')) AS `paymentTotal`,(SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\'))) AS `invoiceTotal`,(ABS((SELECT IFNULL(SUM(invoice_abstracts.total),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW())) - (SELECT IFNULL(SUM(payments.amount),0) FROM `invoices` INNER JOIN `invoice_abstracts` ON  `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id INNER JOIN `payments` ON  `invoices`.`invoice_id` = payments.invoice_id WHERE ( `invoices`.`enrollment_id` = enrollments.enrollment_id AND  `invoice_abstracts`.`state` IN (\'pending\') AND  DATE_ADD(invoice_abstracts.due_date, INTERVAL 1 DAY) < NOW() AND  `payments`.`state` = \'active\')))) AS `invoiceOverdueTotal`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  IFNULL(students.email, \'\') <> \'\' AND  ( `events`.`end` < DATE_ADD(offices.student_publish_date, INTERVAL 1 DAY) AND  ( `events`.`start` > NOW() AND  `event_objects`.`notify_date` IS null)) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `unsentChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `event_objects`.`change_type` IS NOT null AND  IFNULL(students.email, \'\') = \'\' AND  `events`.`start` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `manualChangesCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  ( `events`.`start` > NOW() AND  `details`.`confirmation_state` = \'not_going\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `notGoingCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  `signoffs`.`state` IN (\'disagree\') AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `disagreeCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND   ( `details`.`confirmation_state` IS null AND  `event_objects`.`change_type` IS null AND  `events`.`end` > NOW()) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingResponseCount`,(SELECT COUNT(1) FROM `event_objects` INNER JOIN `events` ON ( `event_objects`.`event_id` = events.event_id AND  `event_objects`.`state` = \'active\' AND  `event_objects`.`object_id` = enrollments.enrollment_id) LEFT JOIN `details` ON  `event_objects`.`event_object_id` = details.event_object_id LEFT JOIN `enrollment_details` ON  `details`.`detail_id` = enrollment_details.enrollment_detail_id LEFT JOIN `signoffs` ON  `details`.`signoff_id` = signoffs.signoff_id INNER JOIN `offices` ON  `events`.`office_id` = offices.office_id INNER JOIN enrollments enrollments ON  `event_objects`.`object_id` = enrollments.enrollment_id INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id WHERE ( `event_objects`.`state` = \'active\' AND  `events`.`state` = \'active\' AND  `details`.`actual_state` IS NOT null AND  (`signoffs`.`state` IN (null) OR signoffs.state IS null) AND  `event_objects`.`type` = \'enrollment\' AND  `students`.`state` = \'active\' AND  `enrollments`.`state` = \'active\') LIMIT 1) AS `pendingSignoffCount`,(SELECT GROUP_CONCAT(evaluation_id) FROM `evaluations` WHERE (   evaluations.evaluation_id IN (SELECT MAX(latestEvaluations.evaluation_id) FROM evaluations latestEvaluations WHERE ( `latestEvaluations`.`state` = \'active\' AND  `evaluations`.`state` = \'active\' AND  `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id)  GROUP BY latestEvaluations.type,latestEvaluations.skill_group_id) AND  `evaluations`.`enrollment_id` = enrollments.enrollment_id)) AS `evaluationIds` FROM `enrollments` INNER JOIN `students` ON  `enrollments`.`student_id` = students.student_id INNER JOIN `offices` ON  `enrollments`.`office_id` = offices.office_id WHERE ( `students`.`state` = \'active\' AND  `offices`.`environment_id` = \'6\' AND  `enrollments`.`office_id` IN (\'7\') AND  `enrollments`.`status_id` IN (\'6314\') AND  `enrollments`.`state` = \'active\')  ORDER BY `studentName` ASC LIMIT 25',duration:0.0654,explain:{ queryBlock:{ costInfo:{ queryCost:'13.90' },selectId:1,orderingOperation:{ costInfo:{ sortCost:'0.63' },nestedLoop:[{ table:{ key:'PRIMARY',ref:['const'],costInfo:{ evalCost:'0.10',readCost:'0.00',prefixCost:'0.00',dataReadPerJoin:'496' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'const',usedColumns:['office_id','environment_id'],possibleKeys:['PRIMARY','fk_offices_environment_id'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:1 } },{ table:{ key:'fk_enrollments_office_id',ref:['const'],costInfo:{ evalCost:'0.63',readCost:'0.75',prefixCost:'11.05',dataReadPerJoin:'860' },filtered:'6.14',keyLength:'8',tableName:'enrollments',accessType:'ref',usedColumns:['enrollment_id','student_id','office_id','create_date','start_date','complete_date','state','contract_id','status_id','object_version_id','package_id','course_id'],possibleKeys:['fk_enrollments_student_id','fk_enrollments_office_id','fk_enrollments_status_id'],usedKeyParts:['office_id'],indexCondition:'(`driver_training`.`enrollments`.`office_id` = 7)',attachedCondition:'(((`driver_training`.`enrollments`.`state` = \'active\') and (`driver_training`.`enrollments`.`status_id` = 6314)) and (`driver_training`.`enrollments`.`student_id` is not null))',rowsExaminedPerScan:103,rowsProducedPerJoin:6 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.06',readCost:'1.58',prefixCost:'13.26',dataReadPerJoin:'693' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','first_name','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }],usingFilesort:true,usingTemporaryTable:true,selectListSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'1.14',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'47K' },filtered:'100.00',keyLength:'8',tableName:'evaluations',accessType:'ref',usedColumns:['evaluation_id','enrollment_id','state'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'<in_optimizer>(`driver_training`.`evaluations`.`evaluation_id`,<exists>(\/* select#14 *\/ select max(`driver_training`.`latestevaluations`.`evaluation_id`) from `driver_training`.`evaluations` `latestevaluations` where ((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\') and (`driver_training`.`latestevaluations`.`enrollment_id` = `driver_training`.`evaluations`.`enrollment_id`)) group by `driver_training`.`latestevaluations`.`type`,`driver_training`.`latestevaluations`.`skill_group_id` having (<cache>(`driver_training`.`evaluations`.`evaluation_id`) = <ref_null_helper>(max(`driver_training`.`latestevaluations`.`evaluation_id`)))))',attachedSubqueries:[{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.39' },selectId:14,groupingOperation:{ table:{ key:'fk_evaluations_enrollment_id',ref:['driver_training.evaluations.enrollment_id'],costInfo:{ evalCost:'0.11',readCost:'2.25',prefixCost:'3.39',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'latestEvaluations',accessType:'ref',usedColumns:['evaluation_id','skill_group_id','enrollment_id','state','type'],possibleKeys:['fk_evaluations_enrollment_id'],usedKeyParts:['enrollment_id'],attachedCondition:'((`driver_training`.`latestevaluations`.`state` = \'active\') and (`driver_training`.`evaluations`.`state` = \'active\'))',rowsExaminedPerScan:11,rowsProducedPerJoin:1 },usingFilesort:false,usingTemporaryTable:true } } }],rowsExaminedPerScan:11,rowsProducedPerJoin:11 },costInfo:{ queryCost:'3.39' },selectId:13 } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:12,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'19.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'<if>(found_match(signoffs), ((`driver_training`.`signoffs`.`state` = NULL) or (`driver_training`.`signoffs`.`state` is null)), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:11,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`end` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'<if>(found_match(details), (`driver_training`.`details`.`confirmation_state` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:10,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'5' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'90.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','actual_state','signoff_id'],possibleKeys:['fk_details_event_object_id','fk_details_signoff_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`actual_state` is not null)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.signoff_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'10.00',keyLength:'8',tableName:'signoffs',accessType:'eq_ref',usedColumns:['signoff_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['signoff_id'],attachedCondition:'(`driver_training`.`signoffs`.`state` = \'disagree\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:9,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'(`driver_training`.`students`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'10.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state'],possibleKeys:['PRIMARY','idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'(`driver_training`.`event_objects`.`type` = \'enrollment\')',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'3' },filtered:'10.00',keyLength:'4',tableName:'details',accessType:'ref',usedColumns:['detail_id','event_object_id','confirmation_state'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],attachedCondition:'(`driver_training`.`details`.`confirmation_state` = \'not_going\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.41' },selectId:8,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') = \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'9.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','change_type'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`change_type` is not null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'2' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usingIndex:true,usedColumns:['office_id'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'1' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'0.40' },selectId:7,nestedLoop:[{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.01',readCost:'0.25',prefixCost:'0.35',dataReadPerJoin:'13' },filtered:'10.00',keyLength:'8',tableName:'enrollments',accessType:'eq_ref',usedColumns:['enrollment_id','student_id','state'],possibleKeys:['PRIMARY','fk_enrollments_student_id'],usedKeyParts:['enrollment_id'],attachedCondition:'(`driver_training`.`enrollments`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.enrollments.student_id'],costInfo:{ evalCost:'0.00',readCost:'0.03',prefixCost:'0.39',dataReadPerJoin:'10' },filtered:'10.00',keyLength:'8',tableName:'students',accessType:'eq_ref',usedColumns:['student_id','email','state'],possibleKeys:['PRIMARY'],usedKeyParts:['student_id'],attachedCondition:'((`driver_training`.`students`.`state` = \'active\') and (ifnull(`driver_training`.`students`.`email`,\'\') <> \'\'))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.00',readCost:'0.01',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'1.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usedColumns:['event_object_id','object_id','event_id','type','state','notify_date'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],indexCondition:'(`driver_training`.`event_objects`.`object_id` = `driver_training`.`enrollments`.`enrollment_id`)',attachedCondition:'((`driver_training`.`event_objects`.`type` = \'enrollment\') and (`driver_training`.`event_objects`.`notify_date` is null))',rowsExaminedPerScan:5,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'5.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','start','end','office_id'],possibleKeys:['PRIMARY','fk_events_office_id'],usedKeyParts:['event_id'],attachedCondition:'((`driver_training`.`events`.`state` = \'active\') and (`driver_training`.`events`.`start` > <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.events.office_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'offices',accessType:'eq_ref',usedColumns:['office_id','student_publish_date'],possibleKeys:['PRIMARY'],usedKeyParts:['office_id'],attachedCondition:'(`driver_training`.`events`.`end` < (`driver_training`.`offices`.`student_publish_date` + interval 1 day))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'fk_details_event_object_id',ref:['driver_training.event_objects.event_object_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'4',tableName:'details',accessType:'ref',usingIndex:true,usedColumns:['detail_id','event_object_id'],possibleKeys:['fk_details_event_object_id'],usedKeyParts:['event_object_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.details.detail_id'],costInfo:{ evalCost:'0.00',readCost:'0.00',prefixCost:'0.41',dataReadPerJoin:'0' },filtered:'100.00',keyLength:'8',tableName:'enrollment_details',accessType:'eq_ref',usingIndex:true,usedColumns:['enrollment_detail_id'],possibleKeys:['PRIMARY'],usedKeyParts:['enrollment_detail_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:6,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:5,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','due_date','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'((`driver_training`.`invoice_abstracts`.`state` = \'pending\') and ((`driver_training`.`invoice_abstracts`.`due_date` + interval 1 day) < <cache>(now())))',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.50' },selectId:4,nestedLoop:[{ table:{ key:'fk_invoices_enrollment_id',ref:['driver_training.enrollments.enrollment_id'],costInfo:{ evalCost:'0.50',readCost:'0.25',prefixCost:'0.75',dataReadPerJoin:'240' },filtered:'100.00',keyLength:'8',tableName:'invoices',accessType:'ref',usingIndex:true,usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['enrollment_id'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.invoices.invoice_id'],costInfo:{ evalCost:'0.05',readCost:'1.25',prefixCost:'2.50',dataReadPerJoin:'1K' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state','total'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'2.47' },selectId:3,nestedLoop:[{ table:{ costInfo:{ evalCost:'0.16',readCost:'1.69',prefixCost:'1.85',dataReadPerJoin:'1K' },filtered:'10.00',tableName:'payments',accessType:'ALL',usedColumns:['invoice_id','state','amount'],possibleKeys:['fk_payments_invoice_id'],attachedCondition:'(`driver_training`.`payments`.`state` = \'active\')',rowsExaminedPerScan:16,rowsProducedPerJoin:1 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.02',readCost:'0.40',prefixCost:'2.41',dataReadPerJoin:'7' },filtered:'10.00',keyLength:'8',tableName:'invoices',accessType:'eq_ref',usedColumns:['invoice_id','enrollment_id'],possibleKeys:['PRIMARY','fk_invoices_enrollment_id'],usedKeyParts:['invoice_id'],attachedCondition:'(`driver_training`.`invoices`.`enrollment_id` = `driver_training`.`enrollments`.`enrollment_id`)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'PRIMARY',ref:['driver_training.payments.invoice_id'],costInfo:{ evalCost:'0.00',readCost:'0.04',prefixCost:'2.47',dataReadPerJoin:'42' },filtered:'10.00',keyLength:'8',tableName:'invoice_abstracts',accessType:'eq_ref',usedColumns:['invoice_abstract_id','state'],possibleKeys:['PRIMARY'],usedKeyParts:['invoice_abstract_id'],attachedCondition:'(`driver_training`.`invoice_abstracts`.`state` = \'pending\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } },{ cacheable:false,dependent:true,queryBlock:{ costInfo:{ queryCost:'3.29' },selectId:2,nestedLoop:[{ table:{ key:'idx_object_event_state',ref:['driver_training.enrollments.enrollment_id','const'],costInfo:{ evalCost:'0.58',readCost:'0.26',prefixCost:'0.84',dataReadPerJoin:'1K' },filtered:'100.00',keyLength:'71',tableName:'event_objects',accessType:'ref',usingIndex:true,usedColumns:['object_id','event_id','state'],possibleKeys:['idx_object_event','fk_event_objects_event_id','idx_object_event_state'],usedKeyParts:['object_id','state'],rowsExaminedPerScan:5,rowsProducedPerJoin:5 } },{ table:{ key:'PRIMARY',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.06',readCost:'1.44',prefixCost:'2.85',dataReadPerJoin:'4K' },filtered:'10.00',keyLength:'8',tableName:'events',accessType:'eq_ref',usedColumns:['event_id','state','module_id'],possibleKeys:['PRIMARY'],usedKeyParts:['event_id'],attachedCondition:'(`driver_training`.`events`.`state` = \'active\')',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_object_module',ref:['driver_training.enrollments.enrollment_id','driver_training.events.module_id'],costInfo:{ evalCost:'0.06',readCost:'0.14',prefixCost:'3.05',dataReadPerJoin:'13' },filtered:'100.00',keyLength:'16',notExists:true,tableName:'object_modules',accessType:'eq_ref',usingIndex:true,usedColumns:['module_id','object_id'],possibleKeys:['unique_object_module','fk_object_modules_module_id'],usedKeyParts:['object_id','module_id'],attachedCondition:'<if>(found_match(object_modules), (`driver_training`.`object_modules`.`module_id` is null), true)',rowsExaminedPerScan:1,rowsProducedPerJoin:0 } },{ table:{ key:'unique_event_id_activity_id',ref:['driver_training.event_objects.event_id'],costInfo:{ evalCost:'0.07',readCost:'0.17',prefixCost:'3.29',dataReadPerJoin:'22' },filtered:'100.00',keyLength:'8',tableName:'event_activities',accessType:'ref',usedColumns:['event_id','duration'],possibleKeys:['unique_event_id_activity_id'],usedKeyParts:['event_id'],rowsExaminedPerScan:1,rowsProducedPerJoin:0 } }] } }] } } },optimized:false,createDate:'2024-01-16T17:45:52+00:00',url:null,request:{ tags:'true',limit:'25',order:'studentName,asc',offset:'0',scores:'true',courses:'true',offices:'true',officeId:'7',students:'true',courseGroups:'true',environmentId:'6',invoiceTotals:'true',officeAvatars:'true',paymentTotals:'true',disagreeCounts:'true',notGoingCounts:'true',studentAvatars:'true',enrollmentStatusId:'6314',manualChangesCounts:'true',unsentChangesCounts:'true',invoiceOverdueTotals:'true',pendingSignoffCounts:'true',enrollmentModuleHours:'true',pendingResponseCounts:'true',scoreGroupSkillGroups:'true',notEnrollmentModuleHours:'true' },queryCost:13.9,path:'\/api\/enrollments?officeId=7\u0026enrollmentStatusId=6314\u0026offset=0\u0026limit=25\u0026order=studentName%2Casc\u0026students=true\u0026studentAvatars=true\u0026unsentChangesCounts=true\u0026manualChangesCounts=true\u0026notGoingCounts=true\u0026disagreeCounts=true\u0026pendingResponseCounts=true\u0026pendingSignoffCounts=true\u0026scores=true\u0026scoreGroupSkillGroups=true\u0026enrollmentModuleHours=true\u0026invoiceTotals=true\u0026paymentTotals=true\u0026invoiceOverdueTotals=true\u0026tags=true\u0026courses=true\u0026courseGroups=true\u0026offices=true\u0026officeAvatars=true\u0026notEnrollmentModuleHours=true\u0026environmentId=6',prettyQuery:'SELECT \n  enrollments.*, \n  (students.first_name) AS `studentName`, \n  (\n    SELECT \n      IFNULL(\n        SUM(event_activities.duration), \n        0\n      ) \/ 60 \n    FROM \n      `events` \n      INNER JOIN `event_objects` ON `events`.`event_id` = event_objects.event_id \n      INNER JOIN `event_activities` ON `events`.`event_id` = event_activities.event_id \n      LEFT JOIN `object_modules` ON (\n        `events`.`module_id` = object_modules.module_id \n        AND `object_modules`.`object_id` = enrollments.enrollment_id\n      ) \n    WHERE \n      (\n        `events`.`state` = \'active\' \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id \n        AND `object_modules`.`module_id` IS null\n      )\n  ) AS `notEnrollmentModuleHours`, \n  (\n    SELECT \n      IFNULL(\n        SUM(payments.amount), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n      INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\') \n        AND `payments`.`state` = \'active\'\n      )\n  ) AS `paymentTotal`, \n  (\n    SELECT \n      IFNULL(\n        SUM(invoice_abstracts.total), \n        0\n      ) \n    FROM \n      `invoices` \n      INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n    WHERE \n      (\n        `invoices`.`enrollment_id` = enrollments.enrollment_id \n        AND `invoice_abstracts`.`state` IN (\'pending\')\n      )\n  ) AS `invoiceTotal`, \n  (\n    ABS(\n      (\n        SELECT \n          IFNULL(\n            SUM(invoice_abstracts.total), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW()\n          )\n      ) - (\n        SELECT \n          IFNULL(\n            SUM(payments.amount), \n            0\n          ) \n        FROM \n          `invoices` \n          INNER JOIN `invoice_abstracts` ON `invoices`.`invoice_id` = invoice_abstracts.invoice_abstract_id \n          INNER JOIN `payments` ON `invoices`.`invoice_id` = payments.invoice_id \n        WHERE \n          (\n            `invoices`.`enrollment_id` = enrollments.enrollment_id \n            AND `invoice_abstracts`.`state` IN (\'pending\') \n            AND DATE_ADD(\n              invoice_abstracts.due_date, INTERVAL 1 DAY\n            ) < NOW() \n            AND `payments`.`state` = \'active\'\n          )\n      )\n    )\n  ) AS `invoiceOverdueTotal`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND IFNULL(students.email, \'\') <> \'\' \n        AND (\n          `events`.`end` < DATE_ADD(\n            offices.student_publish_date, INTERVAL 1 DAY\n          ) \n          AND (\n            `events`.`start` > NOW() \n            AND `event_objects`.`notify_date` IS null\n          )\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `unsentChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `event_objects`.`change_type` IS NOT null \n          AND IFNULL(students.email, \'\') = \'\' \n          AND `events`.`start` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `manualChangesCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `events`.`start` > NOW() \n          AND `details`.`confirmation_state` = \'not_going\'\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `notGoingCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND `signoffs`.`state` IN (\'disagree\') \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `disagreeCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND (\n          `details`.`confirmation_state` IS null \n          AND `event_objects`.`change_type` IS null \n          AND `events`.`end` > NOW()\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingResponseCount`, \n  (\n    SELECT \n      COUNT(1) \n    FROM \n      `event_objects` \n      INNER JOIN `events` ON (\n        `event_objects`.`event_id` = events.event_id \n        AND `event_objects`.`state` = \'active\' \n        AND `event_objects`.`object_id` = enrollments.enrollment_id\n      ) \n      LEFT JOIN `details` ON `event_objects`.`event_object_id` = details.event_object_id \n      LEFT JOIN `enrollment_details` ON `details`.`detail_id` = enrollment_details.enrollment_detail_id \n      LEFT JOIN `signoffs` ON `details`.`signoff_id` = signoffs.signoff_id \n      INNER JOIN `offices` ON `events`.`office_id` = offices.office_id \n      INNER JOIN enrollments enrollments ON `event_objects`.`object_id` = enrollments.enrollment_id \n      INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n    WHERE \n      (\n        `event_objects`.`state` = \'active\' \n        AND `events`.`state` = \'active\' \n        AND `details`.`actual_state` IS NOT null \n        AND (\n          `signoffs`.`state` IN (null) \n          OR signoffs.state IS null\n        ) \n        AND `event_objects`.`type` = \'enrollment\' \n        AND `students`.`state` = \'active\' \n        AND `enrollments`.`state` = \'active\'\n      ) \n    LIMIT \n      1\n  ) AS `pendingSignoffCount`, \n  (\n    SELECT \n      GROUP_CONCAT(evaluation_id) \n    FROM \n      `evaluations` \n    WHERE \n      (\n        evaluations.evaluation_id IN (\n          SELECT \n            MAX(\n              latestEvaluations.evaluation_id\n            ) \n          FROM \n            evaluations latestEvaluations \n          WHERE \n            (\n              `latestEvaluations`.`state` = \'active\' \n              AND `evaluations`.`state` = \'active\' \n              AND `latestEvaluations`.`enrollment_id` = evaluations.enrollment_id\n            ) \n          GROUP BY \n            latestEvaluations.type, \n            latestEvaluations.skill_group_id\n        ) \n        AND `evaluations`.`enrollment_id` = enrollments.enrollment_id\n      )\n  ) AS `evaluationIds` \nFROM \n  `enrollments` \n  INNER JOIN `students` ON `enrollments`.`student_id` = students.student_id \n  INNER JOIN `offices` ON `enrollments`.`office_id` = offices.office_id \nWHERE \n  (\n    `students`.`state` = \'active\' \n    AND `offices`.`environment_id` = \'6\' \n    AND `enrollments`.`office_id` IN (\'7\') \n    AND `enrollments`.`status_id` IN (\'6314\') \n    AND `enrollments`.`state` = \'active\'\n  ) \nORDER BY \n  `studentName` ASC \nLIMIT \n  25;' }] });
  };
}
